import React, { Suspense, useState, useEffect, Fragment, useContext } from 'react';
import '@redhat-cloud-services/frontend-components-inventory-vulnerabilities/dist/cjs/index.css';
import { useRouteMatch } from 'react-router-dom';
import { RegistryContext } from '../../store';

const VulnerabilityTab = () => {
    const [Component, setComponent] = useState(Fragment);
    const { params } = useRouteMatch('/:inventoryId');

    const { getRegistry } = useContext(RegistryContext);
    useEffect(() => {
        setComponent(() => React.lazy((async () => {
            const Vulnerabilities = await import('@redhat-cloud-services/frontend-components-inventory-vulnerabilities/dist/cjs');
            const { SystemCvesStore } = Vulnerabilities;
            getRegistry().register({ SystemCvesStore });
            return Vulnerabilities;
        })));
    }, []);

    return <Suspense>
        <Component customItnlProvider entity={ { id: params.inventoryId } }/>
    </Suspense>;
};

export default VulnerabilityTab;
